"use strict";var alv={};alv.util={trim:function(t){return t.replace(/^\s+|\s+$/g,"")},getPageItemValue:function(t){return t.substring(0,2)==="#P"?$(t).val():t},getConditionResult:function(pExpression){var expressionResult=!0;return pExpression.length&&(expressionResult=eval(pExpression)),expressionResult},getNumberFromString:function(t){return t.length?Number(t):""},getDateFromString:function(t){var s=t.split("/"),e=parseInt(s[2]),i=parseInt(s[1],10),a=parseInt(s[0],10);return new Date(e,i-1,a)},convertDate:function(t,s){var e,i,a,n=s.toUpperCase(),r=n.replace(/[A-Z]+/g,""),o=t.replace(/\d+/g,"");return t.length===s.length&&o===r&&(e=n.indexOf("DD")===-1?"xx":t.substring(n.indexOf("DD"),n.indexOf("DD")+2),i=n.indexOf("MM")===-1?"xx":t.substring(n.indexOf("MM"),n.indexOf("MM")+2),a=n.indexOf("YYYY")===-1?n.indexOf("RRRR")===-1?n.indexOf("YY")===-1?n.indexOf("RR")===-1?"xxxx":t.substring(n.indexOf("RR"),n.indexOf("RR")+2):t.substring(n.indexOf("YY"),n.indexOf("YY")+2):t.substring(n.indexOf("RRRR"),n.indexOf("RRRR")+4):t.substring(n.indexOf("YYYY"),n.indexOf("YYYY")+4)),e+"/"+i+"/"+a}},alv.validators={util:alv.util,isEmpty:function(t){return t===""},isEqual:function(t,s){return t===s},regex:function(t,s){return RegExp(s).test(t)||this.isEmpty(t)},isAlphanumeric:function(t){return this.regex(t,/^[a-z0-9]+$/i)},isNumber:function(t){return this.regex(t,/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/)},isDigit:function(t){return this.regex(t,/^\d+$/)},isEmail:function(t){return this.regex(t,/^[^\s@]+@[^\s@]+\.[^\s@]+$/)},isUrl:function(t){return this.regex(t,/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/)},isDate:function(t,s){var e=RegExp("^(3[01]|[12][0-9]|0?[1-9])/(1[0-2]|0?[1-9])/(?:[0-9]{2})?[0-9]{2}$"),i=this.util.convertDate(t,s);if(i.match(e)){var a=i.split("/"),n=parseInt(a[2]),r=parseInt(a[1],10),o=parseInt(a[0],10),l=new Date(n,r-1,o);if(l.getMonth()+1===r&&l.getDate()===o&&l.getFullYear()===n)return!0}return this.isEmpty(t)},minLength:function(t,s){return t.length>=s||this.isEmpty(t)},maxLength:function(t,s){return s>=t.length||this.isEmpty(t)},rangeLength:function(t,s,e){return this.minLength(t,s)&&this.maxLength(t,e)||this.isEmpty(t)},minNumber:function(t,s){return!this.isEmpty(t)&&!this.isEmpty(s)&&this.isNumber(t)&&this.isNumber(s)?t>=s:!0},maxNumber:function(t,s){return!this.isEmpty(t)&&!this.isEmpty(s)&&this.isNumber(t)&&this.isNumber(s)?s>=t:!0},rangeNumber:function(t,s,e){return this.isEmpty(t)||this.isEmpty(s)||this.isEmpty(e)||!(this.isNumber(t)&&this.isNumber(s)&&this.isNumber(e))||s>e?!0:this.minNumber(t,s)&&this.maxNumber(t,e)},minCheck:function(t,s,e){var i=$(t).filter(":checked").length;return e?this.minNumber(i,s)||i===0:this.minNumber(i,s)},maxCheck:function(t,s){var e=$(t).filter(":checked").length;return this.maxNumber(e,s)||e===0},rangeCheck:function(t,s,e){var i=$(t).filter(":checked").length;return this.rangeNumber(i,s,e)||i===0},minDate:function(t,s,e){var i=new Date,a=new Date;return!this.isEmpty(t)&&!this.isEmpty(s)&&this.isDate(t,e)&&this.isDate(s,e)?(i=this.util.getDateFromString(this.util.convertDate(t,e)),a=this.util.getDateFromString(this.util.convertDate(s,e)),i>=a):!0},maxDate:function(t,s,e){var i=new Date,a=new Date;return!this.isEmpty(t)&&!this.isEmpty(s)&&this.isDate(t,e)&&this.isDate(s,e)?(i=this.util.getDateFromString(this.util.convertDate(t,e)),a=this.util.getDateFromString(this.util.convertDate(s,e)),a>=i):!0},rangeDate:function(t,s,e,i){var a=new Date,n=new Date,r=new Date;return this.isEmpty(t)||this.isEmpty(s)||this.isEmpty(e)||!(this.isDate(t,i)&&this.isDate(s,i)&&this.isDate(e,i))||(a=this.util.getDateFromString(this.util.convertDate(t,i)),n=this.util.getDateFromString(this.util.convertDate(s,i)),r=this.util.getDateFromString(this.util.convertDate(e,i)),n>r)?!0:a>=n&&r>=a}},function($,util,validators){$.fn.alv=function(method,options){function restorePluginSettings(t){var s=$(t);return s.data(constants.pluginId)!==void 0?($.extend(settings,s.data(constants.pluginId)),!0):!1}function extendSettings(t){t&&$.extend(settings,t)}function bindSettings(t,s){extendSettings(s),$(t).data(constants.pluginId,settings)}function init(t){var s=settings.triggeringEvent+"."+constants.pluginPrefix,e="change."+constants.pluginPrefix;switch(settings.validate){case"notEmpty":($(t).hasClass(constants.apexCheckboxClass)||$(t).hasClass(constants.apexRadioClass)||$(t).hasClass(constants.apexShuttleClass)||$(t).prop("tagName")==="SELECT"||$(t).attr("type")==="file")&&settings.triggeringEvent!=="change"&&(s=s+" "+e),t.on(s,isEmptyHandler);break;case"itemType":t.on(s,itemTypeHandler);break;case"equal":t.on(s,isEqualHandler);break;case"regex":t.on(s,regexHandler);break;case"charLength":t.on(s,charLengthHandler);break;case"numberSize":t.on(s,numberSizeHandler);break;case"dateOrder":t.on(s,dateOrderHandler);break;case"totalChecked":t.on(e,totalCheckedHandler);break;default:}return t}function isEmptyHandler(){var t,s=setMsg(settings.errorMsg,"value required");allowValidation(this,constants.notEmptyClass)&&(t=$(this).hasClass(constants.apexCheckboxClass)||$(this).hasClass(constants.apexRadioClass)?!validators.minCheck($(this).find(":checkbox, :radio"),1,!1):$(this).hasClass(constants.apexShuttleClass)?!$(this).find("select.shuttle_right").children().length:$(this).prop("tagName")==="SELECT"||$(this).attr("type")==="file"?validators.isEmpty(this.value):settings.allowWhitespace?validators.isEmpty(this.value):validators.isEmpty(util.trim(this.value)),t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.notEmptyClass,!1),showMessage(this,s)):(setValidationResult(this,constants.notEmptyClass,!0),hideMessage(this)))}function isEqualHandler(){var t=setMsg(settings.errorMsg,"values do not equal");allowValidation(this,constants.equalClass)&&validators.minLength(this.value,settings.validationMinLength)&&(!validators.isEqual(this.value,$(settings.equal).val())&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.equalClass,!1),showMessage(this,t)):(setValidationResult(this,constants.equalClass,!0),hideMessage(this)))}function regexHandler(){var t=setMsg(settings.errorMsg,"invalid value");allowValidation(this,constants.regexClass)&&validators.minLength(this.value,settings.validationMinLength)&&(!validators.regex(this.value,settings.regex)&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.regexClass,!1),showMessage(this,t)):(setValidationResult(this,constants.regexClass,!0),hideMessage(this)))}function itemTypeHandler(){var t,s;if(allowValidation(this,constants.itemTypeClass)&&validators.minLength(this.value,settings.validationMinLength)){switch(settings.itemType){case"alphanumeric":t=validators.isAlphanumeric(this.value),s=setMsg(settings.errorMsg,"not an alphanumeric value");break;case"number":t=validators.isNumber(this.value),s=setMsg(settings.errorMsg,"not a valid number");break;case"digit":t=validators.isDigit(this.value),s=setMsg(settings.errorMsg,"not a valid digit combination");break;case"email":t=validators.isEmail(this.value),s=setMsg(settings.errorMsg,"not a valid e-mail address");break;case"url":t=validators.isUrl(this.value),s=setMsg(settings.errorMsg,"not a valid URL");break;case"date":t=validators.isDate(this.value,settings.dateFormat),s=replaceMsgVars(setMsg(settings.errorMsg,"not a valid date (&1)"),settings.dateFormat);break;default:}!t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.itemTypeClass,!1),showMessage(this,s)):(setValidationResult(this,constants.itemTypeClass,!0),hideMessage(this))}}function charLengthHandler(){var t,s;allowValidation(this,constants.charLengthClass)&&validators.minLength(this.value,settings.validationMinLength)&&(validators.isEmpty(settings.max)?(t=validators.minLength(this.value,settings.min),s=replaceMsgVars(setMsg(settings.errorMsg,"value length too short - min. &1"),settings.min)):validators.isEmpty(settings.min)?(t=validators.maxLength(this.value,settings.max),s=replaceMsgVars(setMsg(settings.errorMsg,"value length too long - max. &1"),settings.max)):(t=validators.rangeLength(this.value,settings.min,settings.max),s=replaceMsgVars(setMsg(settings.errorMsg,"invalid value length - between &1 and &2 only"),settings.min,settings.max)),!t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.charLengthClass,!1),showMessage(this,s)):(setValidationResult(this,constants.charLengthClass,!0),hideMessage(this)))}function numberSizeHandler(){var t,s,e=util.getNumberFromString(this.value),i=util.getNumberFromString(util.getPageItemValue(settings.min)),a=util.getNumberFromString(util.getPageItemValue(settings.max));allowValidation(this,constants.numberSizeClass)&&validators.minLength(this.value,settings.validationMinLength)&&(validators.isEmpty(settings.max)?(t=validators.minNumber(e,i),s=replaceMsgVars(setMsg(settings.errorMsg,"number too small - min. &1"),i)):validators.isEmpty(settings.min)?(t=validators.maxNumber(e,a),s=replaceMsgVars(setMsg(settings.errorMsg,"number too large - max. &1"),a)):(t=validators.rangeNumber(e,i,a),s=replaceMsgVars(setMsg(settings.errorMsg,"invalid number size - between &1 and &2 only"),i,a)),!t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.numberSizeClass,!1),showMessage(this,s)):(setValidationResult(this,constants.numberSizeClass,!0),hideMessage(this)))}function totalCheckedHandler(){var t,s,e=$(this).find(":checkbox, :radio");allowValidation(this,constants.totalCheckedClass)&&(validators.isEmpty(settings.max)?(t=validators.minCheck(e,settings.min,!0),s=replaceMsgVars(setMsg(settings.errorMsg,"please select at least &1 choice(s)"),settings.min)):validators.isEmpty(settings.min)?(t=validators.maxCheck(e,settings.max),s=replaceMsgVars(setMsg(settings.errorMsg,"please select no more than &1 choice(s)"),settings.max)):(t=validators.rangeCheck(e,settings.min,settings.max),s=replaceMsgVars(setMsg(settings.errorMsg,"please select between &1 and &2 choice(s)"),settings.min,settings.max)),!t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.totalCheckedClass,!1),showMessage(this,s)):(setValidationResult(this,constants.totalCheckedClass,!0),hideMessage(this)))}function dateOrderHandler(){var t,s,e=util.getPageItemValue(settings.min),i=util.getPageItemValue(settings.max);allowValidation(this,constants.dateOrderClass)&&validators.minLength(this.value,settings.validationMinLength)&&(validators.isEmpty(settings.max)?(t=validators.minDate(this.value,e,settings.dateFormat),s=replaceMsgVars(setMsg(settings.errorMsg,"this date should lie after &1"),e)):validators.isEmpty(settings.min)?(t=validators.maxDate(this.value,i,settings.dateFormat),s=replaceMsgVars(setMsg(settings.errorMsg,"this date should lie before &1"),i)):(t=validators.rangeDate(this.value,e,i,settings.dateFormat),s=replaceMsgVars(setMsg(settings.errorMsg,"this date should lie between &1 and &2"),e,i)),!t&&util.getConditionResult(settings.condition)?(setValidationResult(this,constants.dateOrderClass,!1),showMessage(this,s)):(setValidationResult(this,constants.dateOrderClass,!0),hideMessage(this)))}function showMessage(t,s){var e=$(t),i='<span class="'+constants.errorMsgClass+" "+t.id+'">'+s+"</span>";if(e.hasClass(constants.itemErrorClass)){var a=$("span."+constants.errorMsgClass+"."+t.id),n=a.index(),r=e.index();r>n&&settings.errorMsgLocation==="before"?a.text(s):r>n&&settings.errorMsgLocation==="after"?(a.remove(),e.after(i)):n>r&&settings.errorMsgLocation==="after"?a.text(s):(a.remove(),e.before(i))}else e.addClass(constants.itemErrorClass),$("[for="+t.id+"]").addClass(constants.labelErrorClass),settings.errorMsgLocation==="before"?e.before(i):e.after(i)}function hideMessage(t){var s=$(t);s.hasClass(constants.itemErrorClass)&&(s.removeClass(constants.itemErrorClass),$("[for="+t.id+"]").removeClass(constants.labelErrorClass),$("span."+constants.errorMsgClass+"."+t.id).remove())}function setMsg(t,s){return validators.isEmpty(t)?s:t}function replaceMsgVars(t){for(var s=t,e=1,i=arguments.length;i>e;e++)s=s.replace("&"+e,arguments[e]);return s}function setValidationResult(t,s,e){$(t).data(s,e)}function keyExists(t,s){return $(t).data(s)!==void 0}function allowValidation(t,s){var e=!0,i=$(t);return keyExists(t,s)?$.each(i.data(),function(t){t.substring(0,3)===constants.pluginPrefix&&i.removeData(t)}):$.each(i.data(),function(t,s){t.substring(0,3)===constants.pluginPrefix&&e===!0&&(e=s)}),setValidationResult(t,s,!0),e}function formHasErrors(t){var s,e,i,a=!1,n=$(t),r=n.find("input, textarea, select, fieldset");return $.each(r,function(){s=$(this),e=s.data("events"),e!==void 0&&$.each(e,function(t){i=t,$.each(this,function(t,e){e.namespace===constants.pluginPrefix&&s.trigger(i+"."+constants.pluginPrefix)})})}),r.hasClass(constants.itemErrorClass)&&($(r).filter("."+constants.itemErrorClass).first().focus(),a=!0),a}function validateFormBeforeSubmit(pFiringElem){var firingElem=$(pFiringElem),origClickEventKey=constants.pluginPrefix+"-"+"origClickEvent",origClickEvent,fixErrorsMsg=setMsg(settings.errorMsg,"Please fix all errors before continuing"),messageBoxId="#alv-msg-box",msgBox='<div class="alv-alert-msg"><a href="#" class="alv-close" onclick="$(\''+messageBoxId+"').children().fadeOut();return false;\">x</a><p>"+fixErrorsMsg+"</p></div>";firingElem.length&&(firingElem.prop("tagName")==="BUTTON"?(origClickEvent=firingElem.attr("onclick"),firingElem.data(origClickEventKey,origClickEvent),firingElem.removeAttr("onclick")):(origClickEvent=firingElem.attr("href"),firingElem.data(origClickEventKey,origClickEvent),firingElem.removeAttr("href")),firingElem.on("click",function(){formHasErrors(settings.formsToSubmit)?($(messageBoxId).length||$("body").append('<div id="'+messageBoxId.substring(1)+'"></div>'),$(messageBoxId).html(msgBox)):eval($(this).data(origClickEventKey))}))}var constants={pluginId:"be.ctb.jq.alv",pluginName:"APEX Live Validation",pluginPrefix:"alv",selector:this.selector,apexCheckboxClass:"checkbox_group",apexRadioClass:"radio_group",apexShuttleClass:"shuttle"};$.extend(constants,{notEmptyClass:constants.pluginPrefix+"-"+"notEmpty",itemTypeClass:constants.pluginPrefix+"-"+"itemType",equalClass:constants.pluginPrefix+"-"+"equal",regexClass:constants.pluginPrefix+"-"+"regex",charLengthClass:constants.pluginPrefix+"-"+"charLength",numberSizeClass:constants.pluginPrefix+"-"+"numberSize",dateOrderClass:constants.pluginPrefix+"-"+"dateOrder",totalCheckedClass:constants.pluginPrefix+"-"+"totalChecked",itemErrorClass:"alv-item-error",labelErrorClass:"alv-label-error",errorMsgClass:"alv-error-msg"});var settings={validate:"notEmpty",triggeringEvent:"blur",condition:"",validationMinLength:0,errorMsg:"",errorMsgLocation:"after",allowWhitespace:!0,itemType:"",dateFormat:"",min:"",max:"",equal:"",regex:"",formsToSubmit:""},methods={init:function(t){var s=$(this);bindSettings(s,t),init(s)},validateForm:function(t){var s=$(this);bindSettings(s,t),validateFormBeforeSubmit(s)},remove:function(){var t=$(this);restorePluginSettings(t)&&method()}};return $(this).each(function(){return methods[method]?methods[method].call($(this),options):typeof method!="object"&&method?($.error("Method "+method+" does not exist on jQuery. "+constants.pluginName),!1):methods.init.call($(this),method)})}}(jQuery,alv.util,alv.validators)